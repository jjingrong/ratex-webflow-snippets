"use strict";function ownKeys(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);if(b)d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable});c.push.apply(c,d)}return c}function _objectSpread(a){for(var b=1;b<arguments.length;b++){var c=arguments[b]!=null?arguments[b]:{};if(b%2){ownKeys(Object(c),true).forEach(function(b){_defineProperty(a,b,c[b])})}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(a,Object.getOwnPropertyDescriptors(c))}else{ownKeys(Object(c)).forEach(function(b){Object.defineProperty(a,b,Object.getOwnPropertyDescriptor(c,b))})}}return a}function _classCallCheck(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}}function _defineProperty(a,b,c){if(b in a){Object.defineProperty(a,b,{value:c,enumerable:true,configurable:true,writable:true})}else{a[b]=c}return a}$(function(){var a=new URLSearchParams(window.location.search);var b=a.get("referral_code");var c=document.getElementById("referral-code");if(c){c.innerText=b;c.style.opacity=1}var d=function a(b,c){var d=this;_classCallCheck(this,a);_defineProperty(this,"_isInitialized",false);_defineProperty(this,"_fieldsValidity",[]);_defineProperty(this,"_lastFieldsValidity",[]);_defineProperty(this,"_lastFormValidState",null);_defineProperty(this,"_validityChangeCallback",null);_defineProperty(this,"_unsubscribeAllFieldInputFn",null);_defineProperty(this,"_getFormElement",function(){return document.getElementById(d.formId)});_defineProperty(this,"_getFormFieldElements",function(){var a=d._getFormElement();return d.fieldConfigs.map(function(b){return a.querySelector("input[name=\"".concat(b.name,"\"]"))})});_defineProperty(this,"_updateFormValidState",function(){var a=d._getFormFieldElements();d._fieldsValidity.forEach(function(b,c){var e=d._lastFieldsValidity[c]!==b;d._lastFieldsValidity[c]=b;if(e&&typeof d.fieldConfigs[c].onValidityChange==="function"){d.fieldConfigs[c].onValidityChange(b,a[c])}});var b=d.getFormValidState();var c=b!==d._lastFormValidState;d._lastFormValidState=b;if(c&&typeof d._validityChangeCallback==="function"){d._validityChangeCallback(b)}});_defineProperty(this,"initialize",function(){if(d._isInitialized){return}var a=d._getFormElement();if(!a){return}var b=d._getFormFieldElements();if(b.findIndex(function(a){return a===null})!==-1){return}var c=[];b.forEach(function(a,b){var e=function inputEventHandler(a){var c=a.target.value;d._fieldsValidity[b]=d.fieldConfigs[b].validator?d.fieldConfigs[b].validator(c):true;d._updateFormValidState()};a.addEventListener("input",e);c.push(function(){a.removeEventListener("input",e)});d._fieldsValidity[b]=d.fieldConfigs[b].validator?d.fieldConfigs[b].validator(a.value):true});d._unsubscribeAllFieldInputFn=function(){c.forEach(function(a){a()})};d._isInitialized=true;return d.getFormValidState()});_defineProperty(this,"deinitialize",function(){if(d._isInitialized){d._unsubscribeAllFieldInputFn();d._validityChangeCallback=null;d._isInitialized=false}});_defineProperty(this,"getFormValidState",function(){return d._fieldsValidity.length===0?true:d._fieldsValidity.findIndex(function(a){return a===false})===-1});_defineProperty(this,"onValidityChange",function(a){d._validityChangeCallback=a});_defineProperty(this,"forceValidityUpdate",function(){var a=d._getFormFieldElements();a.forEach(function(a,b){d._fieldsValidity[b]=d.fieldConfigs[b].validator?d.fieldConfigs[b].validator(a.value):true});d._updateFormValidState()});_defineProperty(this,"getFormData",function(){var a=d._getFormElement();return a?new FormData(a):null});this.formId=b;this.fieldConfigs=c};var e="#9c9c9c";var f=32;var g="#9e9e9e";var h=16;var i=document.createElement("style");i.setAttribute("type","text/css");i.innerHTML="\n/** General loading indicator styling */\n.lds-ring {\n  display: inline-block;\n  position: relative;\n}\n.lds-ring div {\n  box-sizing: border-box;\n  display: block;\n  position: absolute;\n  width: 64px;\n  height: 64px;\n  border: 8px solid #fff;\n  border-radius: 50%;\n  animation: lds-ring 1.2s cubic-bezier(0.5, 0, 0.5, 1) infinite;\n  border-color: #fff transparent transparent transparent;\n}\n.lds-ring div:nth-child(1) {\n  animation-delay: -0.45s;\n}\n.lds-ring div:nth-child(2) {\n  animation-delay: -0.3s;\n}\n.lds-ring div:nth-child(3) {\n  animation-delay: -0.15s;\n}\n@keyframes lds-ring {\n  0% {\n    transform: rotate(0deg);\n  }\n  100% {\n    transform: rotate(360deg);\n  }\n}\n\n/** Button loading indicator styling */\n.button-spinner-wrapper {\n  display: flex;\n  position: absolute;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n  justify-content: center;\n  align-items: center;\n}\n.button-spinner-wrapper .lds-ring {\n  width: ".concat(f,"px;\n  height: ").concat(f,"px;\n}\n.button-spinner-wrapper .lds-ring div {\n  width: ").concat(f,"px;\n  height: ").concat(f,"px;\n  border: ").concat(f/8,"px solid ").concat(e,";\n  border-color: ").concat(e," transparent transparent transparent;\n}\n\n/** Resend otp loading indicator styling */\n.resend-spinner {\n  display: inline;\n  vertical-align: middle;\n}\n.resend-spinner .lds-ring {\n  width: ").concat(h,"px;\n  height: ").concat(h,"px;\n}\n.resend-spinner .lds-ring div {\n  width: ").concat(h,"px;\n  height: ").concat(h,"px;\n  border: ").concat(h/8,"px solid ").concat(g,";\n  border-color: ").concat(g," transparent transparent transparent;\n}");document.getElementsByTagName("head")[0].appendChild(i);var j=function a(b){var c=this;_classCallCheck(this,a);_defineProperty(this,"_showLoading",false);_defineProperty(this,"_canClick",true);_defineProperty(this,"_getElement",function(){return document.getElementById(c._buttonId)});_defineProperty(this,"_updateClickableState",function(){var a=c._getElement();if(!a){return}var b=c._canClick&&!c._showLoading;if(b){a.style.pointerEvents="";a.style.cursor="";a.style.backgroundColor="";a.style.color="";a.style.boxShadow=""}else{a.style.pointerEvents="none";a.style.cursor="default";a.style.backgroundColor="#bcc2c6";a.style.color=c._showLoading?"transparent":"#79868e";a.style.boxShadow="none"}});_defineProperty(this,"setOnClick",function(a){var b=c._getElement();if(b){b.onclick=function(b){b.preventDefault();if(typeof a==="function"){for(var c=arguments.length,d=new Array(c>1?c-1:0),e=1;e<c;e++){d[e-1]=arguments[e]}a.apply(void 0,d)}}}});_defineProperty(this,"setClickable",function(a){c._canClick=a;c._updateClickableState()});_defineProperty(this,"setShowLoading",function(a){var b=c._getElement();if(!b){return}c._showLoading=a;if(a){b.style.color="transparent";b.innerHTML="".concat(c._innerHTML,"<div class=\"button-spinner-wrapper\">\n          <div class=\"lds-ring\"><div></div><div></div><div></div><div></div></div>\n        </div>")}else{b.innerHTML=c._innerHTML;b.style.color=""}c._updateClickableState()});_defineProperty(this,"setText",function(a,b){var d=c._getElement();if(!d){return}var e=a.replace(" ","&nbsp;");d.innerHTML=e;c._innerHTML=e});this._buttonId=b;var d=this._getElement();if(d){this._innerHTML=d.innerHTML}};var k="next-button";var l=new j(k);var m="phone-form";var n=document.getElementById(m);var o="phone-input";var p="phone";var q=document.getElementById(o);var r=window.intlTelInputGlobals.getInstance(q);var s="invalid-phone-error";var t=document.getElementById(s);var u=function showPhoneNumberInvalidMessage(a){t.innerText=a;t.style.visibility="";q.style.borderColor="red"};var v=function hidePhoneNumberInvalidMessage(){t.style.visibility="hidden";q.style.borderColor=""};var w=new d(m,[{name:p,validator:function validator(a){return /^[+]?\d+$/.test(a)&&r.isValidNumber()}}]);var x="otp-phone-number";var y=document.getElementById(x);var z="otp-form";var A=document.getElementById(z);var B="otp-input";var C="otp";var D=document.getElementById(B);var E="invalid-otp-error";var F=document.getElementById(E);var G=function showOtpInvalidMessage(a){F.innerText=a;F.style.visibility="";D.style.borderColor="red"};var H=function hideOtpInvalidMessage(){F.style.visibility="hidden";D.style.borderColor=""};var I=new d(z,[{name:C,validator:function validator(a){return a&&a.length===6}}]);var J="otp-cooldown";var K=document.getElementById(J);var L=function setOtpResendButtonElementDisabled(a){if(a){K.setAttribute("tabIndex","-1");K.style.pointerEvents="none";K.style.cursor="default"}else{K.setAttribute("tabIndex","0");K.style.pointerEvents="";K.style.cursor=""}};var M="cooldown-timer";var N=document.getElementById(M);var O="referral-form";var P=document.getElementById(O);var Q="referral-input";var R="referral";var S=document.getElementById(Q);var T="invalid-referral-error";var U=document.getElementById(T);var V=function showReferralInvalidMessage(a){U.innerText=a;U.style.visibility="";S.style.borderColor="red"};var W=function hideReferralInvalidMessage(){U.style.visibility="hidden";S.style.borderColor=""};var X=new d(O,[{name:R,validator:function validator(a){return!!a&&a.length>0}}]);var Y=function a(b){var c=this;_classCallCheck(this,a);_defineProperty(this,"_currentSectionIndex",0);_defineProperty(this,"_sectionsConfig",[]);_defineProperty(this,"_currentSectionCleanup",undefined);_defineProperty(this,"_handleSectionChange",function(a){var b;if(a>=c._sectionsConfig.length){return}if(typeof c._currentSectionCleanup==="function"){c._currentSectionCleanup();c._currentSectionCleanup=undefined}c._displaySectionIndex(a);c._currentSectionIndex=a;if(typeof((b=c._sectionsConfig[a])===null||b===void 0?void 0:b.setupFn)==="function"){c._currentSectionCleanup=c._sectionsConfig[a].setupFn()}});_defineProperty(this,"_displaySectionIndex",function(a){c._sectionsConfig.forEach(function(b,c){var d=document.getElementById(b.id);if(d&&c!==a){d.style.display="none"}});var b=document.getElementById(c._sectionsConfig[a].id);if(b){b.style.display=""}});_defineProperty(this,"start",function(){c._currentSectionIndex=0;c._handleSectionChange(c._currentSectionIndex)});_defineProperty(this,"goToNextSection",function(){if(c._currentSectionIndex<c._sectionsConfig.length){c._handleSectionChange(c._currentSectionIndex+1)}});_defineProperty(this,"goToPreviousSection",function(){if(c._currentSectionIndex>0){c._handleSectionChange(c._currentSectionIndex-1)}});_defineProperty(this,"goToSectionId",function(a){var b=c._sectionsConfig.findIndex(function(b){return b.id===a});if(b!==-1){c._handleSectionChange(b)}});if(Array.isArray(b)){this._sectionsConfig=b}};var Z=function a(b){var c=this;_classCallCheck(this,a);_defineProperty(this,"_interval",null);_defineProperty(this,"_onTickCallback",null);_defineProperty(this,"setSeconds",function(a){c._seconds=Math.max(0,a||0);c.clearTimer()});_defineProperty(this,"start",function(){var a=c._seconds;if(a>0){if(typeof c._onTickCallback==="function"){c._onTickCallback(a)}c._interval=setInterval(function(){a-=1;if(typeof c._onTickCallback==="function"){c._onTickCallback(a)}if(a===0){c.clearTimer()}},1000)}});_defineProperty(this,"clearTimer",function(){if(typeof c._interval==="number"){clearInterval(c._interval)}});_defineProperty(this,"setOnTick",function(a){c._onTickCallback=a});this.setSeconds(b)};var _=location.hostname==="ratesapp.co.id"?"https://ratesapp.co.id":"https://staging.ratesapp.co.id/rs/api";var aa={"Accept-Language":"id-ID"};var ba="";var ca=0;var da=null;var ea=function logout(){$.ajax({method:"DELETE",url:"".concat(_,"/users/sessions"),headers:_objectSpread(_objectSpread({},aa),{},{Authorization:"Bearer ".concat(da)})});da=null};var fa=new Y([{id:"step-1",setupFn:function setupFn(){l.setText("Mulai");l.setOnClick(function(){fa.goToNextSection()})}},{id:"step-2",setupFn:function setupFn(){var a=function handlePhoneFormInputCountryChangeEvent(){v();w.forceValidityUpdate()};q.addEventListener("countrychange",a);var b=function cleanupPhoneFormInputCountryChangeEventListener(){q.removeEventListener("countrychange",a)};var c=function handlePhoneFormInputChangeEvent(){v()};q.addEventListener("input",c);var d=function cleanupPhoneFormInputChangeEventListener(){q.removeEventListener("input",c)};var e=false;var f=function setPhoneFormProcessing(a){e=a;l.setShowLoading(a);if(a){q.setAttribute("readonly",true)}else{q.removeAttribute("readonly")}};var g=function handleNextClick(){if(e||!r.isValidNumber()){return}v();f(true);var a=r.getNumber();$.ajax({method:"POST",url:"".concat(_,"/v2/users/sessions/otp/new"),headers:aa,dataType:"json",contentType:"application/json",data:JSON.stringify({phoneNumber:a}),success:function success(b){f(false);var c=b.data.cooldownLeft;ba=a;ca=c;fa.goToNextSection()},error:function error(a){var b;f(false);var c=a===null||a===void 0?void 0:(b=a.responseJSON)===null||b===void 0?void 0:b.message;if(!c){c="TODO:Default error message"}u(c)}})};n.onsubmit=function(a){a.preventDefault();g()};l.setText("Lanjut");l.setOnClick(g);w.onValidityChange(function(a){if(!e){l.setClickable(a)}});w.initialize();l.setClickable(w.getFormValidState());return function(){b();d();w.deinitialize()}}},{id:"step-3",setupFn:function setupFn(){if(y){y.innerText=ba}var a=function handleOtpInputChangeEvent(){H()};D.addEventListener("input",a);var c=function cleanupOtpInputChangeEventListener(){D.removeEventListener("input",a)};var d=false;var e=false;var f=function setOtpFormProcessing(a){e=a;l.setShowLoading(a);if(a){D.setAttribute("readonly",true)}else{D.removeAttribute("readonly")}};var g=function setOtpResending(a){d=a;if(a){N.innerHTML="<div class=\"resend-spinner\">\n                <div class=\"lds-ring\"><div></div><div></div><div></div><div></div></div>\n              </div>";L(true)}else{N.innerHTML="";L(false)}};var h=function handleNextClick(){if(e){return}H();f(true);var a=I.getFormData();$.ajax({method:"POST",url:"".concat(_,"/v2/users/sessions/otp/auth"),headers:aa,dataType:"json",contentType:"application/json",data:JSON.stringify({phoneNumber:ba,otp:a===null||a===void 0?void 0:a.get(C)}),success:function success(a){var c=a.data._token;da=c;$.ajax({method:"POST",url:"".concat(_,"/v2/users/me/use-referral-code"),headers:_objectSpread(_objectSpread({},aa),{},{Authorization:"Bearer ".concat(da)}),dataType:"json",contentType:"application/json",data:JSON.stringify({code:b}),success:function success(a){ea();location.assign("https://rates-reseller.webflow.io/signup-success")},error:function error(a){f(false);var b=a.status;var c=a.responseJSON;var d=c.data;if(b===422){var e=d===null||d===void 0?void 0:d.code;if(e===1533){fa.goToSectionId("step-4a");ea();return}}fa.goToNextSection()}})},error:function error(a){var b;f(false);var c=a===null||a===void 0?void 0:(b=a.responseJSON)===null||b===void 0?void 0:b.message;if(!c){c="TODO:"}G(c)}})};var i=new Z(ca);i.setOnTick(function(a){ca=a;if(a<=0){N.innerText="";L(false)}else{var b=Math.floor(a/60);var c=a%60;N.innerText=" ".concat(b,":").concat(c<10?"0".concat(c):c);L(true)}});i.start();K.onclick=function(a){a.preventDefault();if(d){return}if(e){return}if(ca>0){return}g(true);$.ajax({method:"POST",url:"".concat(_,"/v2/users/sessions/otp/new"),headers:aa,dataType:"json",contentType:"application/json",data:JSON.stringify({phoneNumber:ba}),success:function success(a){g(false);var b=a.data.cooldownLeft;ca=b;i.setSeconds(ca);i.start()},error:function error(a){var b;g(false);var c=a===null||a===void 0?void 0:(b=a.responseJSON)===null||b===void 0?void 0:b.message;if(!c){c="TODO:"}window.alert(c)}})};A.onsubmit=function(a){a.preventDefault();h()};l.setText("Lanjut");l.setOnClick(h);I.onValidityChange(function(a){if(!e){l.setClickable(a)}});I.initialize();l.setClickable(I.getFormValidState());return function(){ba="";c();I.deinitialize();i.clearTimer()}}},{id:"step-4",setupFn:function setupFn(){var a=function handleReferralInputChangeEvent(){W()};S.addEventListener("input",a);var b=function cleanupReferralInputChangeEventListener(){S.removeEventListener("input",a)};var c=false;var d=function setReferralFormProcessing(a){c=a;l.setShowLoading(a);if(a){S.setAttribute("readonly",true)}else{S.removeAttribute("readonly")}};var e=function handleNextClick(){if(c){return}W();d(true);var a=X.getFormData();$.ajax({method:"POST",url:"".concat(_,"/v2/users/me/use-referral-code"),headers:_objectSpread(_objectSpread({},aa),{},{Authorization:"Bearer ".concat(da)}),dataType:"json",contentType:"application/json",data:JSON.stringify({code:a===null||a===void 0?void 0:a.get(R)}),success:function success(a){ea();location.assign("https://rates-reseller.webflow.io/signup-success")},error:function error(a){d(false);var b=a===null||a===void 0?void 0:a.status;var c=a===null||a===void 0?void 0:a.responseJSON;var e=c===null||c===void 0?void 0:c.message;var f=c===null||c===void 0?void 0:c.data;if(b===422){var g=f===null||f===void 0?void 0:f.code;if(g===1533){fa.goToSectionId("step-4a");ea();return}}if(!e){e="TODO:"}V(e)}})};l.setText("Lanjut");l.setOnClick(e);X.onValidityChange(function(a){if(!c){l.setClickable(a)}});X.initialize();l.setClickable(X.getFormValidState());return function(){b();X.deinitialize()}}},{id:"step-4a",setupFn:function setupFn(){l.setOnClick(function(){window.location.assign("https://ratesapp.app.link/Website-N5I8")});l.setText("Unduh RateS");l.setClickable(true)}}]);v();H();W();fa.start();$("#".concat(m)).submit(function(){return false});$("#".concat(z)).submit(function(){return false});$("#".concat(O)).submit(function(){return false})});
